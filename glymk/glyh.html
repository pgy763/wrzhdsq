<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<link rel="stylesheet" href="../lib/layui-v2.6.3/css/layui.css" media="all">
		<link rel="stylesheet" href="../css/layuimini.css" media="all">
	</head>
	<body>
		<script type="text/html" id="studentTableToolbar">
			<div class="layui-btn-container">
				<!-- 这里的lay-event="add"和delete在后面的JS代码中要用 -->
				<button class="layui-btn layui-btn-normal layui-btn-sm data-add-btn" lay-event="add" > <a href="http://127.0.0.1:5500/rjzhsjzy/dksq/kindaddition.html">添加用户</a> </button>
				<button class="layui-btn layui-btn-sm layui-btn-danger data-delete-btn" lay-event="delete"> 批量删除 </button>
			</div>
		</script> <!--工具栏设置结束-->
		<!-- 数据表格定义，先隐藏起来，内容由后面的JS代码动态产生；lay-filter="studentTableFilter"在后面的JS代码里用 -->
		<table class="layui-hide" id="studentTable" lay-filter="studentTableFilter"></table>
		<!--用户状态列（看表格预览效果），id="userStatus"是程序员自定，后面JS中用-->
		<script type="text/html" id="userStatus">
			<input type="checkbox" name="status"  checked lay-skin="switch" lay-text="启用|禁用" lay-event="open" lay-filter="modifystatus" {{ d.status == '1'? 'checked' : '' }}/>
		</script>
		<!-- 定义表格最后一列：操作 ；lay-event="detail"、 lay-event="edit"、lay-event="delete"后面JS会用到-->
		<script type="text/html" id="studentTableOperation">
			<a class="layui-btn layui-btn-normal layui-btn-xs data-count-edit" lay-event="detail" href="http://127.0.0.1:5500/rjzhsjzy/glymk/zkxx.html">查看详情</a>
			<a class="layui-btn  layui-btn-xs data-count-edit" lay-event="edit" href="http://127.0.0.1:5500/rjzhsjzy/glymk/xg.html">修改</a>
			<a class="layui-btn layui-btn-xs layui-btn-danger data-count-delete" lay-event="delete">删除</a>
		</script>
		
		<script src="../lib/layui-v2.6.3/layui.js"></script>	
		 <script>
		 	// 使用Layui的表单和表格模块
		 	layui.use(['form', 'table'], function () {
		 		var $ = layui.jquery;     // 获得jQuery
		 			form = layui.form;    // 获得表单模块
		 			table = layui.table;  // 获得表格模块
					layer = layui.layer; 
		 			
		         //渲染表格，也就是设置表格
		 		var tableIns = table.render({
		 			elem: '#studentTable', // 上面表格的id
		 			url: 'user.json', // 表格数据JSON文件的位置
		 			toolbar: '#studentTableToolbar', // 工具栏的id，上面定义的 ；不写的话工具栏不会出现
		 			defaultToolbar: ['filter', 'exports', 'print', {
		 				title: '提示',
		 				layEvent: 'LAYTABLE_TIPS',
		 				icon: 'layui-icon-tips'
		 			}],
		 			cols: [[ // 列定义
		 				{type: "checkbox", width: 50},
		 				{field: 'id', width: 80, title: 'ID', sort: true},
		 				{field: 'realname', width: 80, title: '姓名'},
		 				{field: 'deptname', width: 180, title: '院系'},
		 				{field: 'majorname', width:160, title: '专业'},
		 				{field: 'classname', title: '班级', width: 100},
		 				{field: 'grade', width: 100, title: '年级', sort: true},
		 				{field: 'telephone', width: 120, title: '手机号码'},
		 				{
		 					field : 'status',
		 					width:150,
		 					title : '用户状态',
		 					templet : '#userStatus', // 上面用户状态列定义的id：userStatus
		 					unresize : true,
		 					align: "center"
		 				},					
		 				{title: '操作', minWidth: 130, toolbar: '#studentTableOperation', align: "center"}
		 			]],
		 			limits: [10, 15, 20], // 每页显示条数切换
		 			limit: 15, // 每页默认显示15条数据
		 			page: true, // 不写的话，分页显示不会显示
		 			skin: 'line' // 表格有边框
		 		});
				table.on('tool(studentTableFilter)', function (obj) {
        var data = obj.data;
        if (obj.event === 'delete') {
            layer.confirm('确定要删除该用户吗？', function (index) {
                // 这里可以调用后端删除接口，成功后执行下面的操作
                // 模拟前端删除，从表格中移除该行
                obj.del();
                layer.close(index);
                layer.msg('删除成功');
            });
        }
    });

    // 监听工具栏事件（处理批量删除）
    table.on('toolbar(studentTableFilter)', function (obj) {
        if (obj.event === 'delete') {
            var checkStatus = table.checkStatus('studentTable');
            var data = checkStatus.data;
            if (data.length === 0) {
                layer.msg('请先选择要删除的用户');
                return;
            }
            layer.confirm('确定要批量删除选中的用户吗？', function (index) {
                // 这里可以调用后端批量删除接口，成功后执行下面的操作
                // 模拟前端批量删除，重新渲染表格（实际需根据后端返回更新数据）
                tableIns.reload();
                layer.close(index);
                layer.msg('批量删除成功');
            });
        }
    });

		 		
}); // use函数结束 
		 
		 </script>
	</body>
</html>
